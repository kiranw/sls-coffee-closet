<!DOCTYPE html>
<html>
<head>
	<title>SLS Coffee Closet • Is the SLS coffee machine working?</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter">
	<link rel="stylesheet" href="style.css">
</head>
<body>

<h3>Is the coffee machine working?</h3>
<h1 id="answer">Yes</h1>
<div id="sourcing">Last updated at <div id="timestamp" class="imported-data">time</div></div>

<script>
	function processData(data){
		lastRow = data[data.length-1];
		$("#answer").html(lastRow["Is the machine working?"]);
		$("#timestamp").html(lastRow["Timestamp"]);
		// $("#author").html(lastRow["Do you want credit for updating this? Add your name!"]);
		console.log(answer, timestamp);
	}

	var data;
	fetch('https://sheet2api.com/v1/jV0Ohpc6Qh6v/coffee-machine-status-responses', {
	    method: 'GET',
	    headers: {
	        'Accept': 'application/json',
	    },
	}).then(response => response.json()).then(response => processData(response));
</script>

<hr>
  <form id="form" target="_self" onsubmit="" action="javascript: postToGoogle()">
      <legend><strong>Is it working <em>now</em>?</strong></legend>
      <input type="radio" value="☕️ Yes" name="qs1" />Yes
      <input type="radio" value="😥 No" name="qs1" />No
      <br><br>
    <button type="submit">Submit</button>
  </form>
  <br><br>
  <p>made with ♡ by kiran</p>
  <script>
	function postToGoogle() {
 		var field1 = $("input[type='radio'][name='qs1']:checked").val();
 		var field2 = "n/a";

	   $.ajax({
	     url: "https://docs.google.com/forms/d/e/1FAIpQLSeg4esThvlNpXUo2ClpYMsQlenJ15IaB7XFkpb_dYc3Da44UQ/formResponse",
	     data: {
	    "entry.460804136": field1,
	    "entry.1854639373": field2
	     },
	     type: "POST",
	     dataType: "xml",
	     statusCode: {
	       0: function() {
	         //Success message
	         alert("Success!" + field1 + field2);
	       },
	       200: function() {
	         //Success Message
	         alert("Success!");
	       }
	     }
   });
 }
</script>
</body>
</html>